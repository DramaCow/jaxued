
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://example.com/level_sampler/">
      
      
        <link rel="prev" href="../underspecified_env/">
      
      
        <link rel="next" href="../maze/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.11">
    
    
      
        <title>Level Sampler - Jax UED</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e359304.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="light-green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#jaxued.level_sampler.LevelSampler" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Jax UED" class="md-header__button md-logo" aria-label="Jax UED" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Jax UED
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Level Sampler
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="light-green"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Jax UED" class="md-nav__button md-logo" aria-label="Jax UED" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Jax UED
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Documentation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../underspecified_env/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UnderspecifiedEnv
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Level Sampler
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Level Sampler
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler" class="md-nav__link">
    <span class="md-ellipsis">
      LevelSampler
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.find" class="md-nav__link">
    <span class="md-ellipsis">
      find
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.flush" class="md-nav__link">
    <span class="md-ellipsis">
      flush
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.freshness_weights" class="md-nav__link">
    <span class="md-ellipsis">
      freshness_weights
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.get_levels" class="md-nav__link">
    <span class="md-ellipsis">
      get_levels
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.get_levels_extra" class="md-nav__link">
    <span class="md-ellipsis">
      get_levels_extra
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.initialize" class="md-nav__link">
    <span class="md-ellipsis">
      initialize
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.insert" class="md-nav__link">
    <span class="md-ellipsis">
      insert
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.insert_batch" class="md-nav__link">
    <span class="md-ellipsis">
      insert_batch
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.level_weights" class="md-nav__link">
    <span class="md-ellipsis">
      level_weights
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.sample_replay_decision" class="md-nav__link">
    <span class="md-ellipsis">
      sample_replay_decision
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.sample_replay_level" class="md-nav__link">
    <span class="md-ellipsis">
      sample_replay_level
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.sample_replay_levels" class="md-nav__link">
    <span class="md-ellipsis">
      sample_replay_levels
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.score_weights" class="md-nav__link">
    <span class="md-ellipsis">
      score_weights
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.staleness_weights" class="md-nav__link">
    <span class="md-ellipsis">
      staleness_weights
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.update" class="md-nav__link">
    <span class="md-ellipsis">
      update
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.update_batch" class="md-nav__link">
    <span class="md-ellipsis">
      update_batch
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Environments
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Environments
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maze/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maze
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wrappers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wrappers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maze_dr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maze DR
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maze_plr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maze PLR/ACCEL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maze_paired/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maze PAIRED
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler" class="md-nav__link">
    <span class="md-ellipsis">
      LevelSampler
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.find" class="md-nav__link">
    <span class="md-ellipsis">
      find
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.flush" class="md-nav__link">
    <span class="md-ellipsis">
      flush
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.freshness_weights" class="md-nav__link">
    <span class="md-ellipsis">
      freshness_weights
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.get_levels" class="md-nav__link">
    <span class="md-ellipsis">
      get_levels
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.get_levels_extra" class="md-nav__link">
    <span class="md-ellipsis">
      get_levels_extra
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.initialize" class="md-nav__link">
    <span class="md-ellipsis">
      initialize
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.insert" class="md-nav__link">
    <span class="md-ellipsis">
      insert
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.insert_batch" class="md-nav__link">
    <span class="md-ellipsis">
      insert_batch
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.level_weights" class="md-nav__link">
    <span class="md-ellipsis">
      level_weights
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.sample_replay_decision" class="md-nav__link">
    <span class="md-ellipsis">
      sample_replay_decision
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.sample_replay_level" class="md-nav__link">
    <span class="md-ellipsis">
      sample_replay_level
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.sample_replay_levels" class="md-nav__link">
    <span class="md-ellipsis">
      sample_replay_levels
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.score_weights" class="md-nav__link">
    <span class="md-ellipsis">
      score_weights
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.staleness_weights" class="md-nav__link">
    <span class="md-ellipsis">
      staleness_weights
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.update" class="md-nav__link">
    <span class="md-ellipsis">
      update
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jaxued.level_sampler.LevelSampler.update_batch" class="md-nav__link">
    <span class="md-ellipsis">
      update_batch
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Level Sampler</h1>

<div class="doc doc-object doc-class">



<a id="jaxued.level_sampler.LevelSampler"></a>
  <div class="doc doc-contents first">

  
      <p>The <code>LevelSampler</code> provides all of the functionality associated with a level buffer in a PLR/ACCEL-type method. In the standard Jax style, the level sampler class does not store any data itself, and accepts a <code>sampler</code> object for most operations.</p>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt;</span>
<span class="go">pholder_level       = ...</span>
<span class="go">pholder_level_extra = ...</span>
<span class="go">level_sampler       = LevelSampler(4000)</span>
<span class="go">sampler             = level_sampler.initialize(pholder_level, pholder_level_extra)</span>
<span class="go">should_replay       = level_sampler.sample_replay_decision(sampler, rng)</span>
<span class="go">replay_levels       = level_sampler.sample_replay_levels(sampler, rng, 32) # 32 replay levels</span>
<span class="go">scores              = ... # eval agent</span>
<span class="go">sampler             = level_sampler.insert_batch(sampler, level, scores)</span>
</code></pre></div>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>capacity</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The maximum number of levels that can be stored in the buffer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>replay_prob</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The chance of performing on_replay vs on_new. Defaults to 0.95.</p>
            </div>
          </td>
          <td>
                <code>0.95</code>
          </td>
        </tr>
        <tr>
          <td><code>staleness_coeff</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The weighting factor for staleness. Defaults to 0.5.</p>
            </div>
          </td>
          <td>
                <code>0.5</code>
          </td>
        </tr>
        <tr>
          <td><code>minimum_fill_ratio</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The class will never sample a replay decision until the level buffer is at least as full as specified by this value. Defaults to 1.0.</p>
            </div>
          </td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr>
          <td><code>prioritization_params</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If prioritization="rank", this has a "temperature" field; for "topk" it has a "k" field. If not provided, by default this is initialized to a temperature of 1.0 and k=1. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>duplicate_check</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If this is true, duplicate levels cannot be added to the buffer. This adds some computation to check for duplicates. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="jaxued.level_sampler.LevelSampler.find" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">find</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Returns the index of level in the level buffer. If level is not present, -1 is returned.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sampler</code></td>
          <td>
                <code><span title="jaxued.level_sampler.Sampler">Sampler</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The sampler object</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>level</code></td>
          <td>
                <code><span title="jaxued.environments.underspecified_env.Level">Level</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The level to find</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>int</code></td>          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>index or -1 if not found.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="jaxued.level_sampler.LevelSampler.flush" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">flush</span><span class="p">(</span><span class="n">sampler</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Flushes this sampler, putting it back to its empty state. 
This does update it in place. TODO: Do we want that? Sam: When jitted it doesn't.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sampler</code></td>
          <td>
                <code><span title="jaxued.level_sampler.Sampler">Sampler</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Sampler</code></td>          <td>
                <code><span title="jaxued.level_sampler.Sampler">Sampler</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="jaxued.level_sampler.LevelSampler.freshness_weights" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">freshness_weights</span><span class="p">(</span><span class="n">sampler</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Returns freshness weights for each level.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sampler</code></td>
          <td>
                <code><span title="jaxued.level_sampler.Sampler">Sampler</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="chex.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>chex.Array: shape (self.capacity)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="jaxued.level_sampler.LevelSampler.get_levels" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_levels</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span> <span class="n">level_idx</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Returns the level at a particular index.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sampler</code></td>
          <td>
                <code><span title="jaxued.level_sampler.Sampler">Sampler</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The sampler object</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>level_idx</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The index to return</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Level</code></td>          <td>
                <code><span title="jaxued.environments.underspecified_env.Level">Level</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="jaxued.level_sampler.LevelSampler.get_levels_extra" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_levels_extra</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span> <span class="n">level_idx</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Returns the level extras associated with a particular index</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sampler</code></td>
          <td>
                <code><span title="jaxued.level_sampler.Sampler">Sampler</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The sampler object</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>level_idx</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The index to return</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="jaxued.level_sampler.LevelSampler.initialize" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">initialize</span><span class="p">(</span><span class="n">pholder_level</span><span class="p">,</span> <span class="n">pholder_level_extra</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Returns the <code>sampler</code> object as a dictionary.</p>

<details class="sampler-object-keys" open>
  <summary>Sampler Object Keys</summary>
  <ul>
<li>"levels" (shape (self.capacity, ...)): the levels themselves</li>
<li>"scores" (shape (self.capacity)): the scores of the levels</li>
<li>"timestamps" (shape (self.capacity)): the timestamps of the levels</li>
<li>"size" (int): the number of levels currently in the buffer</li>
<li>"episode_count" (int): the number of episodes that have been played so far</li>
</ul>
</details>


  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pholder_level</code></td>
          <td>
                <code><span title="jaxued.environments.underspecified_env.Level">Level</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A placeholder level that will be used to initialize the level buffer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>pholder_level_extra</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If given, this should be a dictionary with arbitrary keys that is kept track of alongside each level. An example is "max_return" for each level. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Sampler</code></td>          <td>
                <code><span title="jaxued.level_sampler.Sampler">Sampler</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The initialized sampler object</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="jaxued.level_sampler.LevelSampler.insert" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">insert</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">level_extra</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Attempt to insert level into the level buffer.</p>
<p>Insertion occurs when:
- Corresponding score exceeds the score of the lowest weighted level
  currently in the buffer (in which case it will replace it).
- Buffer is not yet at capacity.</p>
<p>Optionally, if the level to be inserted already exists in the level
buffer, the corresponding buffer entry will be updated instead.
(See, <code>duplicate_check</code>)</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sampler</code></td>
          <td>
                <code><span title="jaxued.level_sampler.Sampler">Sampler</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The sampler object</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>level</code></td>
          <td>
                <code><span title="jaxued.environments.underspecified_env.Level">Level</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Level to insert</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>score</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Its score</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>level_extra</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If level extra was given in <code>initialize</code>, then it must be given here too. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple[<span title="jaxued.level_sampler.Sampler">Sampler</span>, int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>tuple[Sampler, int]: The updated sampler, and the level's index in the buffer (-1 if it was not inserted)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="jaxued.level_sampler.LevelSampler.insert_batch" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">insert_batch</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">scores</span><span class="p">,</span> <span class="n">level_extras</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Inserts a batch of levels.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sampler</code></td>
          <td>
                <code><span title="jaxued.level_sampler.Sampler">Sampler</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The sampler object</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>levels</code></td>
          <td>
                <code>_type_</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The levels to insert. This must be a <code>batched</code> level, in that it has an extra dimension at the front.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>scores</code></td>
          <td>
                <code>_type_</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The scores of each level</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>level_extras</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The optional level_extras. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="jaxued.level_sampler.LevelSampler.level_weights" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">level_weights</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span> <span class="n">prioritization</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prioritization_params</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Returns the weights for each level, taking into account both staleness and score.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sampler</code></td>
          <td>
                <code><span title="jaxued.level_sampler.Sampler">Sampler</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The sampler</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>prioritization</code></td>
          <td>
                <code><span title="jaxued.level_sampler.Prioritization">Prioritization</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Possibly overrides self.prioritization. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>prioritization_params</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Possibly overrides self.prioritization_params. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="chex.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>chex.Array: Weights, shape (self.capacity)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="jaxued.level_sampler.LevelSampler.sample_replay_decision" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">sample_replay_decision</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Returns a single boolean indicating if a <code>replay</code> or <code>new</code> step should be taken. This is based on the proportion of the buffer that is filled and the <code>replay_prob</code> parameter.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sampler</code></td>
          <td>
                <code><span title="jaxued.level_sampler.Sampler">Sampler</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The sampler object</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rng</code></td>
          <td>
                <code><span title="chex.PRNGKey">PRNGKey</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>bool</code></td>          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="jaxued.level_sampler.LevelSampler.sample_replay_level" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">sample_replay_level</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Samples a replay level from the buffer. It does this by first computing the weights of each level (using <code>level_weights</code>), and then sampling from the buffer using these weights. The <code>sampler</code> object is updated to reflect the new episode count and the level that was sampled. The level itself is returned as well as the index of the level in the buffer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sampler</code></td>
          <td>
                <code><span title="jaxued.level_sampler.Sampler">Sampler</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The sampler object</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rng</code></td>
          <td>
                <code><span title="chex.PRNGKey">PRNGKey</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple[<span title="jaxued.level_sampler.Sampler">Sampler</span>, tuple[int, <span title="jaxued.environments.underspecified_env.Level">Level</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>tuple[Sampler, tuple[int, Level]]: The updated sampler object, the sampled level's index and the level itself.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="jaxued.level_sampler.LevelSampler.sample_replay_levels" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">sample_replay_levels</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span> <span class="n">rng</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Samples several levels by iteratively calling <code>sample_replay_level</code>. The <code>sampler</code> object is updated to reflect the new episode count and the levels that were sampled.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sampler</code></td>
          <td>
                <code><span title="jaxued.level_sampler.Sampler">Sampler</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The sampler object</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>rng</code></td>
          <td>
                <code><span title="chex.PRNGKey">PRNGKey</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>num</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>How many levels to sample</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple[<span title="jaxued.level_sampler.Sampler">Sampler</span>, tuple[<span title="chex.Array">Array</span>, <span title="jaxued.environments.underspecified_env.Level">Level</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>tuple[Sampler, tuple[chex.Array, Level]]: The updated sampler, an array of indices, and multiple levels.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="jaxued.level_sampler.LevelSampler.score_weights" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">score_weights</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span> <span class="n">prioritization</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prioritization_params</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Returns an array of shape (self.capacity) with the weights of each level (for sampling purposes).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sampler</code></td>
          <td>
                <code><span title="jaxued.level_sampler.Sampler">Sampler</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>prioritization</code></td>
          <td>
                <code><span title="jaxued.level_sampler.Prioritization">Prioritization</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Possibly overrides self.prioritization. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>prioritization_params</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Possibly overrides self.prioritization_params. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="chex.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>chex.Array: Score weights, shape (self.capacity)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="jaxued.level_sampler.LevelSampler.staleness_weights" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">staleness_weights</span><span class="p">(</span><span class="n">sampler</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Returns staleness weights for each level.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sampler</code></td>
          <td>
                <code><span title="jaxued.level_sampler.Sampler">Sampler</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="chex.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>chex.Array: shape (self.capacity)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="jaxued.level_sampler.LevelSampler.update" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">update</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">level_extra</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>This updates the score and level_extras of a level</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sampler</code></td>
          <td>
                <code><span title="jaxued.level_sampler.Sampler">Sampler</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The sampler object</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>idx</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The index of the level</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>score</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The score of the level</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>level_extra</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The associated. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Sampler</code></td>          <td>
                <code><span title="jaxued.level_sampler.Sampler">Sampler</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Updated Sampler</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="jaxued.level_sampler.LevelSampler.update_batch" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">update_batch</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span> <span class="n">level_inds</span><span class="p">,</span> <span class="n">scores</span><span class="p">,</span> <span class="n">level_extras</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Updates the scores and level_extras of a batch of levels.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sampler</code></td>
          <td>
                <code><span title="jaxued.level_sampler.Sampler">Sampler</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The sampler object</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>level_inds</code></td>
          <td>
                <code><span title="chex.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Level indices</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>scores</code></td>
          <td>
                <code><span title="chex.Array">Array</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Scores</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>level_extras</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Sampler</code></td>          <td>
                <code><span title="jaxued.level_sampler.Sampler">Sampler</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Updated Sampler</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.8fd75fb4.min.js"></script>
      
    
  </body>
</html>